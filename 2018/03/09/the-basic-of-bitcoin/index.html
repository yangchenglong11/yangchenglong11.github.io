<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8" />
  
  <title>区块链是什么 | yangcl&#39;s</title>
  <meta name="author" content="Yang Chenglong" />

  
  <meta name="description" content="Yangcl&#39;s Blog" />
  

  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

  <meta property="og:title" content="区块链是什么" />
  <meta property="og:site_name" content="yangcl&#39;s" />

  
  

  
    <meta property="og:image" content="" />
  

  
  <link href="/css/images/favicon.ico" rel="icon" />
  

  <link rel="alternate" href="/atom.xml" title="yangcl&#39;s" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  


  <!-- baidu webmaster push -->
  <script src='//push.zhanzhang.baidu.com/push.js'></script>

</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">yangcl&#39;s</a></h1>
  <h2><a href="/">悟已往之不谏，知来者之可追。</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
      <li><a href="/atom.xml">RSS</a></li>
    
      <li><a href="https://github.com/yangchenglong11">github</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2018-03-09T04:42:40.000Z"><a href="/2018/03/09/the-basic-of-bitcoin/">2018-03-09</a></time>
      
      
  
    <h1 class="title">区块链是什么</h1>
  

    </header>
    <div class="entry">
      
        <p>区块链是一个<strong>具有共享状态的密码性安全交易的单机</strong>。<br><a id="more"></a></p>
<ul>
<li><strong>“密码性安全(Cryptographically secure)”</strong>是指用一个很难被解开的复杂数学机制算法来保证数字货币生产的安全性。将它想象成类似于防火墙的这种。它们使得欺骗系统近乎是一个不可能的事情（比如：构造一笔假的交易，消除一笔交易等等）。</li>
<li><strong>“交易的单机(Transactional singleton machine)”</strong>是指只有一个权威的机器实例为系统中产生的交易负责任。换句话说，只有一个全球真相是大家所相信的。</li>
<li><strong>“具有共享状态(With shared-state)”</strong>是指在这台机器上存储的状态是共享的，对每个人都是开放的。</li>
</ul>
<p>上面所说的复杂数学机制算法主要是指（1）密码学哈希函数，（2）非对称加密。简单的说，密码学哈希函数就是指任意长度的字符串、甚至文件体本身经过Hash函数工厂的加工，都会输出一个固定长度的字符串；同时，输入的字符串或者文件稍微做一丢丢的改动，Hash() 函数给出的输出结果都将发生翻天覆地的改变。注意，Hash()函数是公开的，任何人都能使用。</p>
<p>这个算法主要用于验证信息完整性——在一个信息后面放上这个信息的哈希值，收到信息之后收信人再算一遍哈希值，对比两者就知道这条信息是否被篡改过了。如果被篡改过，哪怕只有一bit，整个哈希值也会截然不同。而根据哈希函数的性质，没有人能够伪造出另一个消息具有同样的哈希值，也就是说篡改过的数据完全不可能通过哈希校验。</p>
<p>非对称加密就是指任何人手里都有两把钥匙，其中一把只有自己知道，叫做“私钥”，以及一把可以公布于众，叫做“公钥”；通过私钥加密的信息，必须通过公钥才能解密，连自己的私钥也无解。公钥可以通过私钥生成多把。</p>
<p>非对称加密除了用于信息加密之外，还有另一个用途，就是身份验证。因为通常情况我们假设一对公私钥，公钥是公开的，而私钥只有本人有，于是一个人如果有对应的私钥，我们就可以认定他是本人。其中一个重要的应用就是数字签名——某个消息后面，发信人对这个消息做哈希运算，然后用私钥加密。接着收信人首先对消息进行哈希运算，接着用相应的公钥解密数字签名，再对比两个哈希值，如果相同，就代表这个消息是本人发出的而且没有被篡改过。</p>
<p>单机不是说它不联网，是指全球只有一个机器或者叫系统，它是由全球所有的节点共同组成的，不属于任何组织或个人，也就是通常所说的去中心化。对于比特币来说这个系统存储着全球所有的交易信息，所以也有人把区块链叫做分布式账本，但区块链不是只可以存储交易，它还可以存储合约，数据等其他内容。</p>
<p>刚刚说了，区块链是一个分布式的系统，它也要解决分布式系统中的共识问题。在区块链之前，就已经有了很多关于分布式共识的研究，发明了许多共识算法。共识算法的核心在于如何解决某个变更在网络中是一致的，是被大家都承认的，同时这个信息是被确定的，不可推翻的。在区块链中则是让所有节点对于新增区块达成共识，也就是说，所有人都要认可新增的区块。</p>
<p>比特币区块链考虑的是公开匿名场景下的最坏保证，引入了工作量证明（Proof of Work）策略来规避少数人恶意破坏数据，并通过概率模型保证最后大家看到的就是合法的最长链。比特币网络需要所有试图参与者（矿工）都首先要付出挖矿的代价，进行算力消耗，越想拿到新区块的决定权，意味着抵押的算力越多。一旦失败，这些算力都会被没收掉，成为沉没成本。当网络中存在众多参与者时，个体试图拿到新区块决定权要付出的算力成本是巨大的，意味着进行一次作恶付出的代价已经超过可能带来的好处。简单来说比特币共识模型就是：模型中有公认的“价值”，每个节点说话都需要一定代价，诚实节点会受到奖励，而恶意节点由于只付出代价而收不到奖励，变相受到了惩罚。</p>
<p>然后我们来看一下比特币区块链是如何运行的，首先我们先从最基本的概念入手—公共账本。假如某几个人之间有频繁的金钱往来，每次交易结束后用现金支付可能会有点麻烦，你们想到了使用账本系统。每次交易后将交易信息写入账本，比如它记录了某个时间 A 转给了 B 1000 元等类似的信息。那么这个账本必须是公开的，每个人都可以查阅信息，同样的每个人也可以添加记录。等到了月底大家对账本的交易记录没有异议就会合计一下，假如某个人的交易显示为负值，则需要向系统交钱补上负值，如果为正值就可以从系统中取钱。</p>
<p>但这样的公共开放的系统存在一个问题，如何保证上面所记录的交易信息都是真实的呢？比如说 A 瞒着 B 在上面偷偷添加了一条 B 转给了 A 1000 元记录，也就是说我们怎么相信账本中所记载的信息都是准确无误的呢？这就用到了我们刚刚说的数字签名技术，记录者在添加每条记录时需在后加上数字签名。其他人通过公钥进行验证此记录是否由他本人添加，同时也可以防止他人对记录进行篡改。但这样仍存在一个问题，某个人可以将某条记录复制多次同样会导致系统出错。所以我们需要将每一条记录编号，这样哈希后的结果就是不一样的，也就是最终的数字签名也是不一样的，这样我们就保证了账本中所记载的信息都是准确无误，也就是解决了账本系统中的记录信任问题。</p>
<p>但这样虽然记录是没有问题的，但月底结算时如果出现有人无法支付欠款的情况该怎么办？为了解决这个问题，我们在每次添加交易时系统需要进行简单的验证，它会计算转账人的余额是否足够用来支出，假如不够，会拒绝添加此条记录。这样就可以避免出现上面提到的情况了。我们可以发现，我们完全不需要现实中的货币，只通过这个账本就可以进行所有的交易了。</p>
<p>现在我们的系统好像是可以解决各种问题了，但这样的一个完美的系统仍需运行在一个中心上，我们要把它运行在哪个可以信任的中心呢？这个系统要由谁来维护呢？这样的一看，我们刚刚解决的信任问题好像又出现了。。。问题好像出在了只有一个账本的身上，那假如我们让每个人都有一份账本，当某个人添加新纪录时他就向其他人广播这条记录，其他人收到消息后就记录在自己的账本中。这样我们的系统就变成了分布式的，看起来还是挺不错的。但还是存在问题，比如说 A 收到了一条 B 支付给 A 1000 元的消息，他怎么保证别人也收到了同样的一条消息呢，否则他就无法在接下来的交易中使用这 1000 元。而且即使别人收到相同的消息，但如何保证其他人接受的顺序是一致的呢？这是个比较麻烦的事情。</p>
<p>当每个人都拥有一份账本时，这个系统已经成为了分布式系统。我们刚刚提出来的问题其实就是分布式系统中的共识问题。我们刚刚讲过了，比特币区块链使用的是工作量证明策略来解决这个问题的。当系统中状态发生变化也就是有新纪录产生时，系统中可能会出现多个不同版本的账本，工作量证明策略选择相信消耗最多资源的那份账本。它基本的思路如下：假如某个人给了你一份交易记录并说，我发现一个数字，将这个数字放在交易记录的后面然后经过哈希算法（这里我们假设是SHA256）之后得到的哈希值前30位为零，我们可以想下找到这样一个数字有多难，SHA256产生的结果为256位，要求前30位为零的概率大概是二的三十次方分之一，差不多是十亿分之一。。。而且这个算法是无法逆向推倒的，所以为了找到这个值，除了暴力枚举外没有什么更好的办法了。而且当我们经过简单的计算验证发现它的哈希值确实符合要求时，我们有理由相信他是付出了很多的工作量的，这就是工作量证明。更加重要的是，这份工作量证明和这份交易记录紧密相关，假如你对记录做了某个微小的改动，哈希值将会发生很大的变化，就需要重新计算才能达到要求。</p>
<p>再回过头来看分布式账本，我们如果想要在系统中只保留一份账本的话，假如每一条交易记录都需要付出这么多的工作量显然是有些不合适的，我们可以将账单整理成区块，区块包含了一系列的交易记录已及相对应的工作量证明，其中不同区块的工作量证明的要求可能是不一样的，这个我们待会再说怎么计算，这里我们先以 60 个零为例，同需要在每份转账记录后加入发送者的数字签名一样，这里只有拥有工作量证明的区块才是合法的区块。为了保证这些区块的顺序，每个区块都要将前一个区块的哈希值加入到当前区块的头部，当你想要改变之前某个区块的内容或者交换区块顺序时，你就要重新计算这个区块以后的所有区块的工作量证明，这样整个系统就变成了区块的一套链，所以叫区块链。</p>
<p><img src="/2018/03/09/the-basic-of-bitcoin/hash_chain.png" alt="hash_chain.png"></p>
<p>在这种体系下，世界上任何一个人都可以成为区块的建立者，他们都可以接受网络中的交易信息并把它们整理成区块，然后花大量的计算完成工作量证明，一旦找到符合要求的值后，他们就将区块广播出去，为了奖励这个建立者的付出，当他完成区块的挖掘后，系统会奖励他一定数额的资产。这样看来，对于试图建立区块也就是通常所说的矿工来说，挖矿就像是买彩票，每个人都想尽快猜出那个数字，进而挖出区块拿到奖励。对于只是想通过他来交易的人来说，他只要接受矿工的广播然后把它加到自己链的末尾就可以了。但这样仍存在一个问题，假如某一时刻，我们收到了两个不同的区块链，我们应该相信哪一个呢？这种情况是很有可能出现的，虽然全网会尽力控制在一个周期内只有一个节点能够成功挖出区块，但是不能够完全避免多个节点同时挖出区块的可能性，这样同时计算出的矿工会沿着自己计算出来的链继续计算下一个区块，所以就会出现两条链，也叫分叉。遇到这种情况时，我们倾向于选择两条链中的较长的那一条，也就是付出工作量较多的那一条。如果目前两条链相等，可以等待下一个区块的产生，这样就可以做出选择，所以即使没有中心机构维持，所有人也都自己维持自己的那份区块链，我们就达成了一个去中心化的共识。</p>
<p><img src="/2018/03/09/the-basic-of-bitcoin/bifurcate.png" alt="bifurcate"></p>
<p>下面我们可以看下这个系统到底有多可信，我们来尝试下在这个系统中伪造信息欺骗他人有多难。比如说 Alice 想要用一个伪造的区块来欺骗 Bob ，于是他将一个包含了 一条 Alice 转账给 Bob 1000 元的消息广播给 Bob，但他并没有将这个区块广播给其他人，这样其他人就会以为  Alice 还拥有那 1000 元，为了欺骗其他人，他需要在其他人之前找到工作量证明，这是很有可能发生的。但同时 Bob 也会收到其他人的广播， 为了让 Bob 相信 Alice ，Alice 必须伪造 Bob 接收到的那个假区块后面的所有区块，这样的话，他可能就此陷入泥潭不能自拔了。。。必须一直计算下去。但仍凭他怎么计算，他的算力如果不是达到了系统的 51%，总会在某个区块被其他人先算出区块，导致他恶意创造的链被抛弃，同时他也浪费了大量算力。所以为了防止伪造情况出现，要求在区块挖出后，当有 6 个区块在其区块后又被挖掘出来，这个区块才会被真正承认。同时为了调整区块被挖出来的频率，公作量证明的难度也是不断变化的，保证大约每 10 分钟挖出一个区块。</p>
<p><img src="/2018/03/09/the-basic-of-bitcoin/double-spending.png" alt="double-spending"></p>

      
    </div>
    
    <footer>
        <div class="alignright">
          
          <a href='javascript:void(0)' class="share-link bdsharebuttonbox" data-cmd="more">分享</a>
        </div>
        
  
  <div class="categories">
    <a href="/categories/BlockChain/">BlockChain</a>
  </div>

        
  
  <div class="tags">
    <a href="/tags/BlockChain/">BlockChain</a>
  </div>

        <!-- partial('post/share') -->
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜索">
    <input type="hidden" name="q" value="site:yangchenglong11.github.io">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/BlockChain/">BlockChain</a><small>8</small></li>
  
    <li><a href="/categories/Docker/">Docker</a><small>1</small></li>
  
    <li><a href="/categories/Golang/">Golang</a><small>15</small></li>
  
    <li><a href="/categories/Linux/">Linux</a><small>5</small></li>
  
    <li><a href="/categories/MongoDB/">MongoDB</a><small>4</small></li>
  
    <li><a href="/categories/Network/">Network</a><small>1</small></li>
  
    <li><a href="/categories/OS/">OS</a><small>2</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">最新文章</h3>
  <ul class="entry">
    
      <li>
        <a href="/2018/04/25/transaction/">transaction</a>
      </li>
    
      <li>
        <a href="/2018/04/10/PoA/">PoA</a>
      </li>
    
      <li>
        <a href="/2018/03/26/mine/">mine</a>
      </li>
    
      <li>
        <a href="/2018/03/18/the-store-of-block/">区块存储</a>
      </li>
    
      <li>
        <a href="/2018/03/16/merkle-patricia-tree/">Merkle Patricia Tree (梅克尔帕特里夏树) 详解</a>
      </li>
    
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">标签</h3>
  <ul class="entry">
  
    <li><a href="/tags/BlockChain/">BlockChain</a><small>8</small></li>
  
    <li><a href="/tags/Docker/">Docker</a><small>1</small></li>
  
    <li><a href="/tags/Golang/">Golang</a><small>16</small></li>
  
    <li><a href="/tags/Linux/">Linux</a><small>5</small></li>
  
    <li><a href="/tags/MongoDB/">MongoDB</a><small>4</small></li>
  
    <li><a href="/tags/Network/">Network</a><small>1</small></li>
  
    <li><a href="/tags/OS/">OS</a><small>2</small></li>
  
  </ul>
</div>


  
<div class="widget tagcloud">
  <h3 class="title">标签云</h3>
  <div class="entry">
    <a href="/tags/BlockChain/" style="font-size: 18px;">BlockChain</a> <a href="/tags/Docker/" style="font-size: 10px;">Docker</a> <a href="/tags/Golang/" style="font-size: 20px;">Golang</a> <a href="/tags/Linux/" style="font-size: 16px;">Linux</a> <a href="/tags/MongoDB/" style="font-size: 14px;">MongoDB</a> <a href="/tags/Network/" style="font-size: 10px;">Network</a> <a href="/tags/OS/" style="font-size: 12px;">OS</a>
  </div>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  <p>
  
  &copy; 2018 Yang Chenglong
  
  All rights reserved.</p>
  <p>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a></p>
</div>
<div class="clearfix"></div>

<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"1","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"16"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script></footer>
  <script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>


<div id='bg'></div>
  
    <script type="text/javascript" src="/live2d/script.js"></script>
    <canvas id="live2dcanvas" width="300" height="400" class="live2d"></canvas>
    <style>
      #live2dcanvas {
        position: fixed;
        right: 0px;
        z-index: 999;
        pointer-events: none;
        bottom: -50px;
      }
    </style>
    <script>loadlive2d("live2dcanvas" ,"/live2d/assets/tororo/tororo.model.json",0.5)</script>
  
</body>
</html>